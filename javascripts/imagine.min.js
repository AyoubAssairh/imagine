/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
Copyright (c) 2010,2011,2012,2013 Morgan Roderick http://roderick.dk
License: MIT - http://mrgnrdrck.mit-license.org

https://github.com/mroderick/PubSubJS
*/

var requirejs,require,define;(function(e){function h(e,t){return f.call(e,t)}function p(e,t){var n,r,i,s,o,a,f,l,h,p,d,v=t&&t.split("/"),m=u.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,u.nodeIdCompat&&c.test(e[o])&&(e[o]=e[o].replace(c,"")),e=v.concat(e);for(h=0;h<e.length;h+=1){d=e[h];if(d===".")e.splice(h,1),h-=1;else if(d===".."){if(h===1&&(e[2]===".."||e[0]===".."))break;h>0&&(e.splice(h-1,2),h-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(h=n.length;h>0;h-=1){r=n.slice(0,h).join("/");if(v)for(p=v.length;p>0;p-=1){i=m[v.slice(0,p).join("/")];if(i){i=i[r];if(i){s=i,a=h;break}}}if(s)break;!f&&g&&g[r]&&(f=g[r],l=h)}!s&&f&&(s=f,a=l),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function d(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){s[e]=t}}function g(n){if(h(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!h(s,n)&&!h(a,n))throw new Error("No "+n);return s[n]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice,c=/\.js$/;r=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return d(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:b(e)}}},t=function(t,n,u,f){var l,c,p,v,y,b=[],w=typeof u,E;f=f||t;if(w==="undefined"||w==="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){v=r(n[y],f),c=v.f;if(c==="require")b[y]=i.require(t);else if(c==="exports")b[y]=i.exports(t),E=!0;else if(c==="module")l=b[y]=i.module(t);else if(h(s,c)||h(o,c)||h(a,c))b[y]=g(c);else{if(!v.p)throw new Error(t+" missing "+c);v.p.load(v.n,d(f,!0),m(c),{}),b[y]=s[c]}}p=u?u.apply(s[t],b):undefined;if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(p!==e||!E)s[t]=p}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){if(typeof s=="string")return i[s]?i[s](o):g(r(s,o).f);if(!s.splice){u=s,u.deps&&n(u.deps,u.callback);if(!o)return;o.splice?(s=o,o=a,a=null):s=e}return o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n},n.config=function(e){return n(e)},requirejs._defined=s,define=function(e,t,n){t.splice||(n=t,t=[]),!h(s,e)&&!h(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("../bower_components/almond/almond.js",function(){}),function(e,t){typeof exports=="object"&&module?module.exports=t():typeof define=="function"&&define.amd?define("../bower_components/pubsub-js/src/pubsub",t):e.PubSub=t()}(typeof window=="object"&&window||this,function(){function r(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function i(e){return function(){throw e}}function s(e,t,n){try{e(t,n)}catch(r){setTimeout(i(r),0)}}function o(e,t,n){e(t,n)}function u(e,n,r,i){var u=t[n],a=i?o:s,f;if(!t.hasOwnProperty(n))return;for(f in u)u.hasOwnProperty(f)&&a(u[f],e,r)}function a(e,t,n){return function(){var i=String(e),s=i.lastIndexOf(".");u(e,e,t,n);while(s!==-1)i=i.substr(0,s),s=i.lastIndexOf("."),u(e,i,t)}}function f(e){var n=String(e),i=Boolean(t.hasOwnProperty(n)&&r(t[n])),s=n.lastIndexOf(".");while(!i&&s!==-1)n=n.substr(0,s),s=n.lastIndexOf("."),i=Boolean(t.hasOwnProperty(n)&&r(t[n]));return i}function l(e,t,n,r){var i=a(e,t,r),s=f(e);return s?(n===!0?i():setTimeout(i,0),!0):!1}var e={},t={},n=-1;return e.publish=function(t,n){return l(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return l(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,r){if(typeof r!="function")return!1;t.hasOwnProperty(e)||(t[e]={});var i="uid_"+String(++n);return t[e][i]=r,i},e.unsubscribe=function(e){var n=typeof e=="string",r=!1,i,s,o,u;for(i in t)if(t.hasOwnProperty(i)){s=t[i];if(n&&s[e]){delete s[e],r=e;break}if(!n)for(o in s)s.hasOwnProperty(o)&&s[o]===e&&(delete s[o],r=!0)}return r},e}),define("pubsub",["../bower_components/pubsub-js/src/pubsub"],function(e){function t(t,n){return e.publish(t,n)}function n(t,n){return e.subscribe(t,n)}return{publish:t,subscribe:n}}),define("util/mouse",[],function(){function e(e,t){var n=t.getBoundingClientRect();return{x:e.clientX-n.left*(t.width/n.width),y:e.clientY-n.top*(t.height/n.height)}}function t(e,t,n,r){var i=t.options,s=0,o=0,u=n.width-i.width,a=n.height-i.height,f,l;return f=e.x-r.x,f=f<s?s:f>u?u:f,l=e.y-r.y,l=l<o?o:l>a?a:l,{x:f,y:l}}function n(e,t){var n=e.options;return n.left<=t.x&&t.x<=n.left+n.width&&n.top<=t.y&&t.y<=n.top+n.height}function r(e,t){var r=-1,i;for(index in t){var s=t[index],o=n(s,e);o&&index>r&&(i=index)}return i?t[i]:!1}return{windowToCanvas:e,clampToCanvas:t,isTargetHit:n,getTargetObject:r}}),define("canvas",["pubsub","util/mouse"],function(e,t){function i(e){this.id=e,this.canvas=document.getElementById(this.id),this.ctx=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this,!1),this.canvas.addEventListener("mousemove",this,!1),this.canvasObjects=[],this.activeObject}function s(i){var s=t.windowToCanvas(i,this.canvas),o=t.getTargetObject(s,this.canvasObjects);n=o?!0:!1,o&&(this.setActiveObject(o),e.publish("mousedown",{event:i,object:o})),o&&n&&(r.x=s.x-o.options.left,r.y=s.y-o.options.top,window.addEventListener("mousemove",this,!1)),this.canvas.removeEventListener("mousedown",this,!1),window.addEventListener("mouseup",this,!1)}function o(i){var s=this.getActiveObject(),o=t.windowToCanvas(i,this.canvas);if(n&&s){var u=s.options,a=t.clampToCanvas(o,s,this.canvas,r);u.left=a.x,u.top=a.y,e.publish("objectdrag",{event:i,object:s})}if(!n){var s=t.getTargetObject(o,this.canvasObjects);this.setActiveObject(s),this.setCursorOnActiveObject(s),s&&e.publish("objecthover",{event:i,object:s})}}function u(r){var i=t.windowToCanvas(r,this.canvas),s=t.getTargetObject(i,this.canvasObjects);this.canvas.addEventListener("mousedown",this,!1),window.removeEventListener("mouseup",this,!1),n&&(n=!1,window.removeEventListener("mousemove",this,!1)),s&&e.publish("mouseup",{event:r,object:s})}var n,r={};return i.prototype.getCanvasId=function(){return this.id},i.prototype.getCanvas=function(){return this.canvas},i.prototype.getContext=function(){return this.ctx},i.prototype.getObjectCount=function(){return this.canvasObjects.length},i.prototype.getActiveObject=function(){return this.activeObject},i.prototype.setActiveObject=function(e){return this.activeObject=e},i.prototype.remove=function(e){var t=this.canvasObjects.indexOf(e);return t!=-1&&(this.canvasObjects.splice(t,1),this.reDrawObjects()),this},i.prototype.add=function(e){e.draw(this.ctx),e.options.layer=this.getObjectCount()+1,this.canvasObjects.push(e)},i.prototype.reDrawObjects=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(object in this.canvasObjects){var e=this.canvasObjects[object];e.draw(this.ctx)}},i.prototype.setCursorOnActiveObject=function(e){this.canvas.style.cursor=e?"move":"default"},i.prototype.handleEvent=function(e){switch(e.type){case"mousedown":s.apply(this,[e]);break;case"mousemove":o.apply(this,[e]);break;case"mouseup":u.apply(this,[e]);break;case"mouseover":mouseOverListener.apply(this,[e])}this.reDrawObjects()},i}),define("shapes/shape",["pubsub"],function(e){function t(){}return t.prototype.initializeOptions=function(e,t){this.options=t||{};for(option in e)this.options[option]=this.options[option]||e[option],this.options.hasOwnProperty("radius")&&(this.options.width=this.options.width||this.options.radius*2,this.options.height=this.options.height||this.options.radius*2)},t.prototype.set=function(e){for(option in e)this.options[option]=e[option]},t.prototype.on=function(t,n){var r=this;e.subscribe(t,function(e,t){r===t.object&&n&&n(e,t)})},t}),define("shapes/rectangle",["shapes/shape"],function(e){function n(e){this.initializeOptions(t,e)}var t={left:0,top:0,fill:"black",width:100,height:100,strokeStyle:"#fff",strokeWidth:null};return n.prototype=new e,n.prototype.draw=function(e){e.fillStyle=this.options.fill,e.fillRect(this.options.left,this.options.top,this.options.width,this.options.height),e.strokeStyle=this.options.strokeStyle,e.lineWidth=this.options.strokeWidth,this.options.strokeWidth&&e.strokeRect(this.options.left,this.options.top,this.options.width,this.options.height)},n}),define("shapes/circle",["shapes/shape"],function(e){function n(e){this.initializeOptions(t,e)}var t={left:0,top:0,fill:"black",radius:25};return n.prototype=new e,n.prototype.draw=function(e){e.beginPath(),e.arc(this.options.left+this.options.radius,this.options.top+this.options.radius,this.options.radius,0,2*Math.PI,!1),e.fillStyle=this.options.fill,e.fill(),this.options.strokeWidth&&e.strokeRect(this.options.left,this.options.top,this.options.width,this.options.height)},n}),define("shapes/image",["shapes/shape"],function(e){function n(e,n){this.imageObj=e,n.width=n.width||this.imageObj.width,n.height=n.height||this.imageObj.height,this.initializeOptions(t,n)}var t={left:0,top:0,angle:0,opacity:1};return n.prototype=new e,n.prototype.draw=function(e){e.drawImage(this.imageObj,this.options.left,this.options.top,this.options.width,this.options.height)},n}),define("shapes/text",["shapes/shape"],function(e){function n(e){this.initializeOptions(t,e)}var t={fontSize:24,font:"Times New Roman",fontWeight:"normal",text:"text",left:0,top:0,baseline:"top",fill:"black",strokeStyle:null,strokeWidth:0};return n.prototype=new e,n.prototype.draw=function(e){e.font=this.options.fontSize+"px "+this.options.font,e.fillStyle=this.options.fill,e.textBaseline=this.options.baseline;var t=e.measureText(this.options.text),n=this.options.width||t.width,r=this.options.height||this.options.fontSize+6;this.options.width=n,this.options.height=r,e.fillText(this.options.text,this.options.left,this.options.top),this.options.strokeWidth&&e.strokeRect(this.options.left,this.options.top,this.options.width,this.options.height)},n}),define("imagine",["canvas","shapes/rectangle","shapes/circle","shapes/image","shapes/text"],function(e,t,n,r,i){return window.imagine=window.imagine||{},imagine={Canvas:e,Rectangle:t,Circle:n,Image:r,Text:i},imagine}),require(["imagine"],function(){}),define("main",function(){});